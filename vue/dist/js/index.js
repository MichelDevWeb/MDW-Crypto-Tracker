(()=>{"use strict";var t={220:(t,e,s)=>{var o=s(751),a=s(641);function i(t,e,s,o,i,n){const r=(0,a.g2)("Popup");return(0,a.uX)(),(0,a.Wv)(r)}var n=s(33);const r={class:"app-container"},c={class:"header"},l={class:"header-content"},d={class:"stats-container"},p={class:"stat-item"},h={class:"stat-value"},u={class:"stat-item"},m={class:"stat-value"},k={class:"stat-item"},g={key:0},v={class:"search-container"},f=["value"],y={class:"table-container"},C={class:"table table-dark table-hover"},L=["title"],b={class:"sort-icon"},P={class:"sort-icon"},w={class:"sort-icon"},_={class:"sort-icon"},T={class:"sort-icon"},S=["onClick","title"],$={class:"rank-icon-cell"},D={class:"rank-number"},I=["src","alt"],A=["href","title"],E={class:"value-pnl-container"},x={key:0},j={class:"action-buttons"},F=["onClick"],U=["onClick"],V={key:0,class:"loading-spinner"},H={key:1,class:"alert alert-danger"},M={key:2,class:"modal edit-transaction-modal"},W={class:"modal-content"},X={class:"form-group"},O={class:"transaction-type-toggle"},Q={class:"form-group"},z={class:"input-with-preview"},B={class:"preview-text"},Z={class:"form-group"},q={class:"input-with-preview"},J={class:"preview-text"},K={class:"form-group"},R={key:0,class:"transaction-preview"},G={class:"modal-actions"},N={type:"submit",class:"btn-primary"},Y={key:3,class:"modal history-modal"},tt={class:"modal-content transaction-history-modal"},et={class:"modal-header"},st={class:"coin-info"},ot=["src","alt"],at={class:"summary-grid"},it={class:"summary-card"},nt={class:"summary-value"},rt={class:"symbol-badge"},ct={class:"summary-card"},lt={class:"summary-value"},dt={class:"summary-card"},pt={class:"summary-value"},ht={class:"summary-card"},ut={class:"transaction-list"},mt={class:"tx-main"},kt={class:"tx-type"},gt={class:"tx-icon"},vt={class:"tx-amount"},ft={class:"symbol-badge"},yt={class:"tx-price"},Ct={class:"tx-total"},Lt={class:"tx-secondary"},bt={class:"tx-date"},Pt={class:"tx-actions"},wt=["onClick"],_t=["onClick"];function Tt(t,e,s,i,Tt,St){return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",c,[(0,a.Lk)("div",l,[e[27]||(e[27]=(0,a.Lk)("h3",null,"MDW Crypto",-1)),(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.Lk)("span",h,"$"+(0,n.v_)(St.formatPrice(St.totalCost)),1),e[22]||(e[22]=(0,a.Lk)("span",{class:"stat-label"},"Cost",-1))]),e[25]||(e[25]=(0,a.Lk)("div",{class:"stat-divider"},null,-1)),(0,a.Lk)("div",u,[(0,a.Lk)("span",m,"$"+(0,n.v_)(St.formatPrice(St.totalValue)),1),e[23]||(e[23]=(0,a.Lk)("span",{class:"stat-label"},"Value",-1))]),e[26]||(e[26]=(0,a.Lk)("div",{class:"stat-divider"},null,-1)),(0,a.Lk)("div",k,[(0,a.Lk)("span",{class:(0,n.C4)(["stat-value",St.getPnLClass(St.totalProfitLoss)])},[(0,a.eW)((0,n.v_)(St.formatPnL(St.totalProfitLoss))+" ",1),St.totalCost?((0,a.uX)(),(0,a.CE)("small",g,"("+(0,n.v_)(St.formatPnLPercentage(St.totalProfitLoss,St.totalCost))+")",1)):(0,a.Q3)("",!0)],2),e[24]||(e[24]=(0,a.Lk)("span",{class:"stat-label"},"P&L",-1))])])])]),(0,a.Lk)("div",v,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>Tt.searchQuery=t),onKeyup:e[1]||(e[1]=(0,o.jR)(((...t)=>St.handleSearch&&St.handleSearch(...t)),["enter"])),class:"form-control search-input",placeholder:"Search coins..."},null,544),[[o.Jo,Tt.searchQuery]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>Tt.selectedApi=t),onChange:e[3]||(e[3]=(...t)=>St.handleApiChange&&St.handleApiChange(...t)),class:"form-select api-select"},e[28]||(e[28]=[(0,a.Lk)("option",{value:"coingecko"},"CoinGecko",-1),(0,a.Lk)("option",{value:"coincap"},"CoinCap",-1)]),544),[[o.u1,Tt.selectedApi]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>Tt.pageSize=t),onChange:e[5]||(e[5]=(...t)=>St.fetchCoins&&St.fetchCoins(...t)),class:"form-select page-size-select"},e[29]||(e[29]=[(0,a.Lk)("option",{value:"25"},"25 per page",-1),(0,a.Lk)("option",{value:"50"},"50 per page",-1),(0,a.Lk)("option",{value:"100"},"100 per page",-1),(0,a.Lk)("option",{value:"200"},"200 per page",-1)]),544),[[o.u1,Tt.pageSize]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>Tt.currentPage=t),onChange:e[7]||(e[7]=(...t)=>St.fetchCoins&&St.fetchCoins(...t)),class:"form-select page-select"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Tt.totalPages,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:t}," Page "+(0,n.v_)(t),9,f)))),128))],544),[[o.u1,Tt.currentPage]])]),(0,a.Lk)("div",y,[(0,a.Lk)("table",C,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,[(0,a.Lk)("div",{onClick:e[8]||(e[8]=(...t)=>St.togglePortfolioView&&St.togglePortfolioView(...t)),class:"portfolio-trigger",title:Tt.showPortfolio?"Show all coins":"Show portfolio coins"},(0,n.v_)(Tt.showPortfolio?"🌐":"📊"),9,L)]),(0,a.Lk)("th",{onClick:e[9]||(e[9]=t=>St.sortBy("rank")),class:"sortable"},[e[30]||(e[30]=(0,a.eW)(" Rank ")),(0,a.Lk)("span",b,(0,n.v_)(St.getSortIcon("rank")),1)]),(0,a.Lk)("th",{onClick:e[10]||(e[10]=t=>St.sortBy("symbol")),class:"sortable"},[e[31]||(e[31]=(0,a.eW)(" Symbol ")),(0,a.Lk)("span",P,(0,n.v_)(St.getSortIcon("symbol")),1)]),(0,a.Lk)("th",{onClick:e[11]||(e[11]=t=>St.sortBy("price")),class:"sortable"},[e[32]||(e[32]=(0,a.eW)(" Price ")),(0,a.Lk)("span",w,(0,n.v_)(St.getSortIcon("price")),1)]),(0,a.Lk)("th",{onClick:e[12]||(e[12]=t=>St.sortBy("priceChange24h")),class:"sortable"},[e[33]||(e[33]=(0,a.eW)(" 24h ")),(0,a.Lk)("span",_,(0,n.v_)(St.getSortIcon("priceChange24h")),1)]),(0,a.Lk)("th",{onClick:e[13]||(e[13]=t=>St.sortBy("value")),class:"sortable"},[e[34]||(e[34]=(0,a.eW)(" Value/PnL ")),(0,a.Lk)("span",T,(0,n.v_)(St.getSortIcon("value")),1)]),e[35]||(e[35]=(0,a.Lk)("th",null,"Actions",-1))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(St.sortedCoins,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id},[(0,a.Lk)("td",null,[(0,a.Lk)("button",{onClick:e=>St.togglePortfolio(t),class:(0,n.C4)(["favorite-btn",t.inPortfolio?"favorite-active":"favorite-inactive"]),title:t.inPortfolio?"Remove from portfolio":"Add to portfolio"},(0,n.v_)(t.inPortfolio?"⭐":"☆"),11,S)]),(0,a.Lk)("td",$,[(0,a.Lk)("span",D,"#"+(0,n.v_)(t.rank),1),(0,a.Lk)("img",{src:t.image,alt:t.symbol,class:"coin-icon"},null,8,I)]),(0,a.Lk)("td",null,[(0,a.Lk)("a",{href:`https://www.coingecko.com/en/coins/${t.id}`,target:"_blank",class:"coin-link",title:t.name},(0,n.v_)(t.symbol.toUpperCase()),9,A)]),(0,a.Lk)("td",null,"$"+(0,n.v_)(St.formatPrice(t.price)),1),(0,a.Lk)("td",{class:(0,n.C4)(["price-change-pill",St.getPriceChangeClass(t.priceChange24h)])},(0,n.v_)(St.formatPriceChange(t.priceChange24h)),3),(0,a.Lk)("td",null,[(0,a.Lk)("div",E,[(0,a.Lk)("div",null,"$"+(0,n.v_)(St.formatPrice(t.holdings*t.price)),1),(0,a.Lk)("div",{class:(0,n.C4)(["pnl-text",St.getPnLClass(t.pnl)])},[(0,a.eW)((0,n.v_)(St.formatPnL(t.pnl))+" ",1),t.holdings?((0,a.uX)(),(0,a.CE)("small",x," ("+(0,n.v_)(St.formatPnLPercentage(t.pnl,t.holdings*t.price))+") ",1)):(0,a.Q3)("",!0)],2)])]),(0,a.Lk)("td",null,[(0,a.Lk)("div",j,[(0,a.Lk)("button",{onClick:e=>St.openTransactionModal(t),class:"action-btn",title:"Add Transaction"}," ➕ ",8,F),(0,a.Lk)("button",{onClick:e=>St.viewTransactions(t),class:"action-btn",title:"View Transactions"}," 👁️ ",8,U)])])])))),128))])])]),Tt.loading?((0,a.uX)(),(0,a.CE)("div",V,e[36]||(e[36]=[(0,a.Lk)("div",{class:"spinner-border text-light",role:"status"},[(0,a.Lk)("span",{class:"visually-hidden"},"Loading...")],-1)]))):(0,a.Q3)("",!0),Tt.error?((0,a.uX)(),(0,a.CE)("div",H,(0,n.v_)(Tt.error),1)):(0,a.Q3)("",!0),e[46]||(e[46]=(0,a.Lk)("footer",{class:"footer"},[(0,a.Lk)("a",{href:"https://chrome.google.com/webstore/detail/mdw-crypto-portfolio-track/njpeiacpcgcfdojjedocmegpkcljibmk",target:"_blank",class:"store-link"}," Available on Chrome Web Store "),(0,a.Lk)("span",{class:"link-separator"},"•"),(0,a.Lk)("a",{href:"https://github.com/MichelDevWeb/MDW-Crypto-Tracker/tree/main",target:"_blank",class:"store-link"}," View on GitHub ")],-1)),Tt.showTransactionModal?((0,a.uX)(),(0,a.CE)("div",M,[(0,a.Lk)("div",W,[(0,a.Lk)("h3",null,(0,n.v_)(Tt.editingTransaction?"Edit":"Add")+" Transaction for "+(0,n.v_)(Tt.selectedCoin?.name),1),(0,a.Lk)("form",{onSubmit:e[20]||(e[20]=(0,o.D$)(((...t)=>St.saveTransaction&&St.saveTransaction(...t)),["prevent"]))},[(0,a.Lk)("div",X,[e[37]||(e[37]=(0,a.Lk)("label",null,"Type:",-1)),(0,a.Lk)("div",O,[(0,a.Lk)("button",{type:"button",class:(0,n.C4)(["type-btn","buy"===Tt.transaction.type?"active":""]),onClick:e[14]||(e[14]=t=>Tt.transaction.type="buy")}," Buy ",2),(0,a.Lk)("button",{type:"button",class:(0,n.C4)(["type-btn","sell"===Tt.transaction.type?"active":""]),onClick:e[15]||(e[15]=t=>Tt.transaction.type="sell")}," Sell ",2)])]),(0,a.Lk)("div",Q,[e[38]||(e[38]=(0,a.Lk)("label",null,"Amount:",-1)),(0,a.Lk)("div",z,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=t=>Tt.transaction.amount=t),step:"any",required:"",class:"enhanced-input"},null,512),[[o.Jo,Tt.transaction.amount]]),(0,a.Lk)("span",B,"≈ $"+(0,n.v_)(St.formatPrice(Tt.transaction.amount*Tt.transaction.price)),1)])]),(0,a.Lk)("div",Z,[e[39]||(e[39]=(0,a.Lk)("label",null,"Price per coin:",-1)),(0,a.Lk)("div",q,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":e[17]||(e[17]=t=>Tt.transaction.price=t),step:"any",required:"",class:"enhanced-input"},null,512),[[o.Jo,Tt.transaction.price]]),(0,a.Lk)("span",J,"Current: $"+(0,n.v_)(St.formatPrice(Tt.selectedCoin?.price)),1)])]),(0,a.Lk)("div",K,[e[40]||(e[40]=(0,a.Lk)("label",null,"Date:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"datetime-local","onUpdate:modelValue":e[18]||(e[18]=t=>Tt.transaction.date=t),required:"",class:"enhanced-input"},null,512),[[o.Jo,Tt.transaction.date]])]),null!==St.transactionPnL?((0,a.uX)(),(0,a.CE)("div",R,[e[41]||(e[41]=(0,a.Lk)("div",{class:"preview-label"},"Transaction PnL:",-1)),(0,a.Lk)("div",{class:(0,n.C4)(["preview-value",St.getPnLClass(St.transactionPnL)])},(0,n.v_)(St.formatPnL(St.transactionPnL)),3)])):(0,a.Q3)("",!0),(0,a.Lk)("div",G,[(0,a.Lk)("button",N,(0,n.v_)(Tt.editingTransaction?"Update":"Save"),1),(0,a.Lk)("button",{type:"button",onClick:e[19]||(e[19]=(...t)=>St.closeTransactionModal&&St.closeTransactionModal(...t)),class:"btn-secondary"}," Cancel ")])],32)])])):(0,a.Q3)("",!0),Tt.showTransactionHistory?((0,a.uX)(),(0,a.CE)("div",Y,[(0,a.Lk)("div",tt,[(0,a.Lk)("div",et,[(0,a.Lk)("div",st,[(0,a.Lk)("img",{src:Tt.selectedCoin?.image,alt:Tt.selectedCoin?.symbol,class:"coin-header-icon"},null,8,ot),(0,a.Lk)("h3",null,(0,n.v_)(Tt.selectedCoin?.symbol.toUpperCase())+" Transactions",1)]),(0,a.Lk)("button",{onClick:e[21]||(e[21]=(...t)=>St.closeTransactionHistory&&St.closeTransactionHistory(...t)),class:"close-btn"},"×")]),(0,a.Lk)("div",at,[(0,a.Lk)("div",it,[e[42]||(e[42]=(0,a.Lk)("div",{class:"summary-label"},"Holdings",-1)),(0,a.Lk)("div",nt,[(0,a.eW)((0,n.v_)(Tt.selectedCoin?.holdings)+" ",1),(0,a.Lk)("span",rt,(0,n.v_)(Tt.selectedCoin?.symbol.toUpperCase()),1)])]),(0,a.Lk)("div",ct,[e[43]||(e[43]=(0,a.Lk)("div",{class:"summary-label"},"Avg. Price",-1)),(0,a.Lk)("div",lt,"$"+(0,n.v_)(St.formatPrice(St.calculateAveragePrice(Tt.selectedCoin))),1)]),(0,a.Lk)("div",dt,[e[44]||(e[44]=(0,a.Lk)("div",{class:"summary-label"},"Total Value",-1)),(0,a.Lk)("div",pt,"$"+(0,n.v_)(St.formatPrice(Tt.selectedCoin?.holdings*Tt.selectedCoin?.price)),1)]),(0,a.Lk)("div",ht,[e[45]||(e[45]=(0,a.Lk)("div",{class:"summary-label"},"Total P&L",-1)),(0,a.Lk)("div",{class:(0,n.C4)(["summary-value",St.getPnLClass(Tt.selectedCoin?.pnl)])},[(0,a.eW)((0,n.v_)(St.formatPnL(Tt.selectedCoin?.pnl))+" ",1),(0,a.Lk)("small",null,"("+(0,n.v_)(St.formatPnLPercentage(Tt.selectedCoin?.pnl,Tt.selectedCoin?.holdings*Tt.selectedCoin?.price))+")",1)],2)])]),(0,a.Lk)("div",ut,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Tt.coinTransactions,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:(0,n.C4)(["tx-item",t.type])},[(0,a.Lk)("div",mt,[(0,a.Lk)("div",kt,[(0,a.Lk)("span",gt,(0,n.v_)("buy"===t.type?"↓":"↑"),1),(0,a.eW)(" "+(0,n.v_)(t.type.toUpperCase()),1)]),(0,a.Lk)("div",vt,[(0,a.eW)((0,n.v_)(t.amount)+" ",1),(0,a.Lk)("span",ft,(0,n.v_)(Tt.selectedCoin?.symbol.toUpperCase()),1)]),(0,a.Lk)("div",yt,"$"+(0,n.v_)(St.formatPrice(t.price)),1),(0,a.Lk)("div",Ct,"$"+(0,n.v_)(St.formatPrice(t.amount*t.price)),1),(0,a.Lk)("div",{class:(0,n.C4)(["tx-pnl",St.getPnLClass(St.calculateTransactionPnL(t))])},(0,n.v_)(St.formatPnL(St.calculateTransactionPnL(t))),3)]),(0,a.Lk)("div",Lt,[(0,a.Lk)("span",bt,(0,n.v_)(new Date(t.timestamp).toLocaleString()),1),(0,a.Lk)("div",Pt,[(0,a.Lk)("button",{onClick:e=>St.editTransaction(t),class:"action-mini",title:"Edit"},"✏️",8,wt),(0,a.Lk)("button",{onClick:e=>St.deleteTransaction(t),class:"action-mini",title:"Delete"},"🗑️",8,_t)])])],2)))),128))])])])):(0,a.Q3)("",!0)])}const St={data(){return{coins:[],loading:!1,error:null,searchQuery:"",selectedApi:"coingecko",pageSize:25,portfolio:new Set,currentPage:1,totalPages:10,showPortfolio:!0,showTransactionModal:!1,selectedCoin:null,transaction:{type:"buy",amount:0,price:0,date:(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16)},sortConfig:{key:"rank",direction:"asc"},showTransactionHistory:!1,coinTransactions:[],editingTransaction:null}},computed:{portfolioCoins(){return this.coins.filter((t=>this.portfolio.has(t.id)))},displayedCoins(){return this.showPortfolio?this.portfolioCoins:this.coins},sortedCoins(){const t=[...this.displayedCoins];return this.sortConfig.key?t.sort(((t,e)=>{let s=t[this.sortConfig.key],o=e[this.sortConfig.key];return"symbol"===this.sortConfig.key?(s=s.toUpperCase(),o=o.toUpperCase()):"holdings"===this.sortConfig.key?(s=s||0,o=o||0):"value"===this.sortConfig.key&&(s=(t.holdings||0)*t.price,o=(e.holdings||0)*e.price),s<o?"asc"===this.sortConfig.direction?-1:1:s>o?"asc"===this.sortConfig.direction?1:-1:0})):t},transactionPnL(){if(!this.selectedCoin||!this.transaction.amount||!this.transaction.price)return null;const t=this.selectedCoin.price*this.transaction.amount,e=this.transaction.price*this.transaction.amount;return"buy"===this.transaction.type?t-e:e-t},totalCost(){return this.portfolioCoins.reduce(((t,e)=>{const s=e.transactions||[];let o=0,a=0;return s.forEach((t=>{"buy"===t.type?(o+=t.price*t.amount,a+=t.amount):(o-=t.price*t.amount,a-=t.amount)})),t+o}),0)},totalValue(){return this.portfolioCoins.reduce(((t,e)=>t+e.holdings*e.price),0)},totalProfitLoss(){return this.totalValue-this.totalCost}},methods:{async fetchCoins(){this.loading=!0,this.error=null;try{if(this.showPortfolio){const{portfolio:t=[]}=await chrome.storage.sync.get("portfolio");if("coingecko"===this.selectedApi){const e=t.join(",");if(e){const t=await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${e}&order=market_cap_desc`),s=await t.json();this.coins=this.parseCoingeckoData(s)}else this.coins=[]}else{const e=t.map((async t=>{const e=await fetch(`https://api.coincap.io/v2/assets/${t}`),{data:s}=await e.json();return s})),s=await Promise.all(e);this.coins=this.parseCoinCapData(s)}}else{const t="coingecko"===this.selectedApi?`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=${this.pageSize}&page=${this.currentPage}`:`https://api.coincap.io/v2/assets?limit=${this.pageSize}&offset=${(this.currentPage-1)*this.pageSize}`,e=await fetch(t),s=await e.json();this.coins="coingecko"===this.selectedApi?this.parseCoingeckoData(s):this.parseCoinCapData(s.data)}await this.updateHoldings()}catch(t){this.error="Failed to fetch cryptocurrency data",console.error(t)}finally{this.loading=!1}},parseCoingeckoData(t){return t.map((t=>({id:t.id,symbol:t.symbol,name:t.name,image:t.image,rank:t.market_cap_rank,price:t.current_price,priceChange24h:t.price_change_percentage_24h,inPortfolio:this.portfolio.has(t.id)})))},parseCoinCapData(t){return t.map((t=>({id:t.id,symbol:t.symbol,name:t.name,image:`https://assets.coincap.io/assets/icons/${t.symbol.toLowerCase()}@2x.png`,rank:t.rank,price:parseFloat(t.priceUsd),priceChange24h:parseFloat(t.changePercent24Hr),inPortfolio:this.portfolio.has(t.id)})))},formatPrice(t){return null===t||void 0===t?"N/A":t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:6})},formatPriceChange(t){return null===t||void 0===t?"N/A":`${t>=0?"+":""}${t.toFixed(2)}%`},getPriceChangeClass(t){return{profit:t>0,loss:t<0,neutral:0===t}},async handleSearch(){if(this.searchQuery.length>2){this.loading=!0,this.error=null;try{let t;if("coingecko"===this.selectedApi){t=`https://api.coingecko.com/api/v3/search?query=${this.searchQuery}`;const e=await fetch(t),s=await e.json(),o=s.coins.slice(0,this.pageSize).map((t=>t.id)).join(",");if(o){const t=await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${o}&order=market_cap_desc`),e=await t.json();this.coins=this.parseCoingeckoData(e)}else this.coins=[]}else{t=`https://api.coincap.io/v2/assets?search=${this.searchQuery}&limit=${this.pageSize}`;const e=await fetch(t),s=await e.json();this.coins=this.parseCoinCapData(s.data)}}catch(t){this.error="Failed to search cryptocurrencies",console.error(t)}finally{this.loading=!1}}else 0===this.searchQuery.length&&this.fetchCoins()},handleApiChange(){this.fetchCoins()},togglePortfolio(t){this.portfolio.has(t.id)?this.portfolio.delete(t.id):this.portfolio.add(t.id),t.inPortfolio=!t.inPortfolio,this.savePortfolio()},async savePortfolio(){await chrome.storage.sync.set({portfolio:Array.from(this.portfolio)})},async loadPortfolio(){const t=await chrome.storage.sync.get("portfolio");this.portfolio=new Set(t.portfolio||[]),this.showPortfolio=this.portfolio.size>0},togglePortfolioView(){this.showPortfolio=!this.showPortfolio,this.fetchCoins()},formatHoldings(t){return t||"0"},openTransactionModal(t){this.selectedCoin=t,this.transaction.price=t.price,this.transaction.date=(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16),this.showTransactionModal=!0},closeTransactionModal(){this.showTransactionModal=!1,this.selectedCoin=null,this.transaction={type:"buy",amount:0,price:0,date:(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16)}},async saveTransaction(){try{const t={...this.transaction,coinId:this.selectedCoin.id,timestamp:new Date(this.transaction.date).getTime()},{transactions:e=[]}=await chrome.storage.sync.get("transactions");let s=[...e];if(this.editingTransaction){const o=e.findIndex((t=>t.timestamp===this.editingTransaction.timestamp&&t.coinId===this.editingTransaction.coinId));-1!==o&&(s[o]=t)}else s.push(t);if(await chrome.storage.sync.set({transactions:s}),await this.updateHoldings(),this.showTransactionHistory&&this.selectedCoin){const t=this.coins.find((t=>t.id===this.selectedCoin.id));this.selectedCoin=t;const e=s.filter((t=>t.coinId===this.selectedCoin.id));this.coinTransactions=e.sort(((t,e)=>e.timestamp-t.timestamp))}this.editingTransaction=null,this.closeTransactionModal()}catch(t){console.error("Failed to save transaction:",t)}},async updateHoldings(){const{transactions:t=[]}=await chrome.storage.sync.get("transactions"),e={},s={};t.forEach((t=>{e[t.coinId]||(e[t.coinId]=0,s[t.coinId]=[]),e[t.coinId]+="buy"===t.type?t.amount:-t.amount,s[t.coinId].push(t)})),this.coins=this.coins.map((t=>({...t,holdings:e[t.id]||0,transactions:s[t.id]||[],pnl:this.calculatePnL({...t,holdings:e[t.id]||0,transactions:s[t.id]||[]})})))},sortBy(t){this.sortConfig.key===t?this.sortConfig.direction="asc"===this.sortConfig.direction?"desc":"asc":(this.sortConfig.key=t,this.sortConfig.direction="asc")},getSortIcon(t){return this.sortConfig.key!==t?"↕️":"asc"===this.sortConfig.direction?"↑":"↓"},async viewTransactions(t){this.selectedCoin=t;const{transactions:e=[]}=await chrome.storage.sync.get("transactions");this.coinTransactions=e.filter((e=>e.coinId===t.id)).sort(((t,e)=>e.timestamp-t.timestamp)),this.showTransactionHistory=!0},closeTransactionHistory(){this.showTransactionHistory=!1,this.selectedCoin=null,this.coinTransactions=[]},editTransaction(t){this.editingTransaction=t,this.transaction={type:t.type,amount:t.amount,price:t.price,date:new Date(t.timestamp).toLocaleString("sv-SE").slice(0,16)},this.showTransactionModal=!0},async deleteTransaction(t){if(confirm("Are you sure you want to delete this transaction?"))try{const{transactions:e=[]}=await chrome.storage.sync.get("transactions"),s=e.filter((e=>e.timestamp!==t.timestamp||e.coinId!==t.coinId));if(await chrome.storage.sync.set({transactions:s}),await this.updateHoldings(),this.selectedCoin){const t=this.coins.find((t=>t.id===this.selectedCoin.id));this.selectedCoin=t;const e=s.filter((t=>t.coinId===this.selectedCoin.id));this.coinTransactions=e.sort(((t,e)=>e.timestamp-t.timestamp))}}catch(e){console.error("Failed to delete transaction:",e)}},calculatePnL(t){if(!t.holdings||!t.transactions)return 0;let e=0,s=0;t.transactions.forEach((t=>{"buy"===t.type?(e+=t.price*t.amount,s+=t.amount):(e-=t.price*t.amount,s-=t.amount)}));const o=s?e/s:0,a=t.price*t.holdings,i=o*t.holdings;return a-i},formatPnL(t){return t?`${t>=0?"+":""}$${Math.abs(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"$0.00"},getPnLClass(t){return t?t>0?"profit":"loss":"neutral"},calculateTransactionPnL(t){if(!this.selectedCoin||!t)return 0;const e=this.selectedCoin.price*t.amount,s=t.price*t.amount;return"buy"===t.type?e-s:s-e},formatPnLPercentage(t,e){if(!e)return"0%";const s=t/Math.abs(e)*100;return`${s>=0?"+":""}${s.toFixed(2)}%`},calculateAveragePrice(t){if(!t?.transactions||0===t.transactions.length)return 0;let e=0,s=0;return t.transactions.forEach((t=>{"buy"===t.type?(e+=t.price*t.amount,s+=t.amount):(e-=t.price*t.amount,s-=t.amount)})),s?e/s:0}},async mounted(){await this.loadPortfolio(),await this.fetchCoins(),await this.updateHoldings()}};var $t=s(262);const Dt=(0,$t.A)(St,[["render",Tt],["__scopeId","data-v-acb6a700"]]),It=Dt,At={name:"App",components:{Popup:It}},Et=(0,$t.A)(At,[["render",i]]),xt=Et,jt=(0,o.Ef)(xt);jt.mount("#app")}},e={};function s(o){var a=e[o];if(void 0!==a)return a.exports;var i=e[o]={exports:{}};return t[o](i,i.exports,s),i.exports}s.m=t,(()=>{var t=[];s.O=(e,o,a,i)=>{if(!o){var n=1/0;for(d=0;d<t.length;d++){for(var[o,a,i]=t[d],r=!0,c=0;c<o.length;c++)(!1&i||n>=i)&&Object.keys(s.O).every((t=>s.O[t](o[c])))?o.splice(c--,1):(r=!1,i<n&&(n=i));if(r){t.splice(d--,1);var l=a();void 0!==l&&(e=l)}}return e}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,a,i]}})(),(()=>{s.d=(t,e)=>{for(var o in e)s.o(e,o)&&!s.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{var t={57:0};s.O.j=e=>0===t[e];var e=(e,o)=>{var a,i,[n,r,c]=o,l=0;if(n.some((e=>0!==t[e]))){for(a in r)s.o(r,a)&&(s.m[a]=r[a]);if(c)var d=c(s)}for(e&&e(o);l<n.length;l++)i=n[l],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(d)},o=self["webpackChunkmdw_crypto_portfolio_tracker"]=self["webpackChunkmdw_crypto_portfolio_tracker"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})();var o=s.O(void 0,[504],(()=>s(220)));o=s.O(o)})();