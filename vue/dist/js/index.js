(()=>{"use strict";var t={121:(t,s,e)=>{var o=e(751),a=e(641);function i(t,s,e,o,i,n){const r=(0,a.g2)("Popup");return(0,a.uX)(),(0,a.Wv)(r)}var n=e(33);const r={class:"app-container"},c={class:"header"},l={class:"header-content"},d={class:"title-and-stats"},p={key:0},h={class:"stats-group"},u={class:"stat-item"},m={class:"stat-value"},k={class:"stat-item"},g={class:"stat-value"},v={class:"stat-item"},f={key:0},y={class:"search-container"},C=["value"],L={class:"table-container"},b={class:"table table-dark table-hover"},P=["title"],w={class:"sort-icon"},_={class:"sort-icon"},T={class:"sort-icon"},S={class:"sort-icon"},$={class:"sort-icon"},x=["onClick","title"],D={class:"rank-icon-cell"},E={class:"rank-number"},I=["src","alt"],A=["href","title"],j={class:"value-pnl-cell"},F={class:"value-pnl-container"},V={class:"value-text"},U={key:0},H={class:"hover-actions"},M=["onClick"],W=["onClick"],X={key:0,class:"loading-spinner"},Q={key:1,class:"alert alert-danger"},O={key:2,class:"modal edit-transaction-modal"},z={class:"modal-content"},B={class:"form-group"},Z={class:"transaction-type-toggle"},q={class:"form-group"},J={class:"input-with-preview"},K={class:"preview-text"},R={class:"form-group"},G={class:"input-with-preview"},N={class:"preview-text"},Y={class:"form-group"},tt={key:0,class:"transaction-preview"},st={class:"modal-actions"},et={type:"submit",class:"btn-primary"},ot={key:3,class:"modal history-modal"},at={class:"modal-content transaction-history-modal"},it={class:"modal-header"},nt={class:"coin-info"},rt=["src","alt"],ct={class:"summary-grid"},lt={class:"summary-card"},dt={class:"summary-value"},pt={class:"symbol-badge"},ht={class:"summary-card"},ut={class:"summary-value"},mt={class:"summary-card"},kt={class:"summary-value"},gt={class:"summary-card"},vt={class:"transaction-list"},ft={class:"tx-main"},yt={class:"tx-type"},Ct={class:"tx-icon"},Lt={class:"tx-amount"},bt={class:"symbol-badge"},Pt={class:"tx-price"},wt={class:"tx-total"},_t={class:"tx-secondary"},Tt={class:"tx-date"},St={class:"tx-actions"},$t=["onClick"],xt=["onClick"];function Dt(t,s,e,i,Dt,Et){return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",c,[(0,a.Lk)("div",l,[(0,a.Lk)("div",d,[s[25]||(s[25]=(0,a.Lk)("h3",null,"MDW Crypto Portfolio Tracker",-1)),Dt.showPortfolio?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",h,[(0,a.Lk)("div",u,[s[22]||(s[22]=(0,a.Lk)("span",{class:"stat-label"},"Cost:",-1)),(0,a.Lk)("span",m,"$"+(0,n.v_)(Et.formatPrice(Et.totalCost)),1)]),(0,a.Lk)("div",k,[s[23]||(s[23]=(0,a.Lk)("span",{class:"stat-label"},"Value:",-1)),(0,a.Lk)("span",g,"$"+(0,n.v_)(Et.formatPrice(Et.totalValue)),1)])]),(0,a.Lk)("div",v,[s[24]||(s[24]=(0,a.Lk)("span",{class:"stat-label"},"P&L:",-1)),(0,a.Lk)("span",{class:(0,n.C4)(["stat-value",Et.getPnLClass(Et.totalProfitLoss)])},[(0,a.eW)((0,n.v_)(Et.formatPnL(Et.totalProfitLoss))+" ",1),Et.totalCost?((0,a.uX)(),(0,a.CE)("small",f,"("+(0,n.v_)(Et.formatPnLPercentage(Et.totalProfitLoss,Et.totalCost))+")",1)):(0,a.Q3)("",!0)],2)])])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",y,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>Dt.searchQuery=t),onKeyup:s[1]||(s[1]=(0,o.jR)(((...t)=>Et.handleSearch&&Et.handleSearch(...t)),["enter"])),class:"form-control search-input",placeholder:"Search coins..."},null,544),[[o.Jo,Dt.searchQuery]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>Dt.selectedApi=t),onChange:s[3]||(s[3]=(...t)=>Et.handleApiChange&&Et.handleApiChange(...t)),class:"form-select api-select"},s[26]||(s[26]=[(0,a.Lk)("option",{value:"coingecko"},"CoinGecko",-1),(0,a.Lk)("option",{value:"coincap"},"CoinCap",-1)]),544),[[o.u1,Dt.selectedApi]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>Dt.pageSize=t),onChange:s[5]||(s[5]=(...t)=>Et.fetchCoins&&Et.fetchCoins(...t)),class:"form-select page-size-select"},s[27]||(s[27]=[(0,a.Lk)("option",{value:"25"},"25 per page",-1),(0,a.Lk)("option",{value:"50"},"50 per page",-1),(0,a.Lk)("option",{value:"100"},"100 per page",-1),(0,a.Lk)("option",{value:"200"},"200 per page",-1)]),544),[[o.u1,Dt.pageSize]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":s[6]||(s[6]=t=>Dt.currentPage=t),onChange:s[7]||(s[7]=(...t)=>Et.fetchCoins&&Et.fetchCoins(...t)),class:"form-select page-select"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Dt.totalPages,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:t}," Page "+(0,n.v_)(t),9,C)))),128))],544),[[o.u1,Dt.currentPage]])]),(0,a.Lk)("div",L,[(0,a.Lk)("table",b,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,[(0,a.Lk)("div",{onClick:s[8]||(s[8]=(...t)=>Et.togglePortfolioView&&Et.togglePortfolioView(...t)),class:"portfolio-trigger",title:Dt.showPortfolio?"Show all coins":"Show portfolio coins"},(0,n.v_)(Dt.showPortfolio?"🌐":"📊"),9,P)]),(0,a.Lk)("th",{onClick:s[9]||(s[9]=t=>Et.sortBy("rank")),class:"sortable"},[s[28]||(s[28]=(0,a.eW)(" Rank ")),(0,a.Lk)("span",w,(0,n.v_)(Et.getSortIcon("rank")),1)]),(0,a.Lk)("th",{onClick:s[10]||(s[10]=t=>Et.sortBy("symbol")),class:"sortable"},[s[29]||(s[29]=(0,a.eW)(" Symbol ")),(0,a.Lk)("span",_,(0,n.v_)(Et.getSortIcon("symbol")),1)]),(0,a.Lk)("th",{onClick:s[11]||(s[11]=t=>Et.sortBy("price")),class:"sortable"},[s[30]||(s[30]=(0,a.eW)(" Price ")),(0,a.Lk)("span",T,(0,n.v_)(Et.getSortIcon("price")),1)]),(0,a.Lk)("th",{onClick:s[12]||(s[12]=t=>Et.sortBy("priceChange24h")),class:"sortable"},[s[31]||(s[31]=(0,a.eW)(" 24h ")),(0,a.Lk)("span",S,(0,n.v_)(Et.getSortIcon("priceChange24h")),1)]),(0,a.Lk)("th",{onClick:s[13]||(s[13]=t=>Et.sortBy("value")),class:"sortable"},[s[32]||(s[32]=(0,a.eW)(" Value/PnL ")),(0,a.Lk)("span",$,(0,n.v_)(Et.getSortIcon("value")),1)])])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Et.sortedCoins,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id,class:"coin-row"},[(0,a.Lk)("td",null,[(0,a.Lk)("button",{onClick:s=>Et.togglePortfolio(t),class:(0,n.C4)(["favorite-btn",t.inPortfolio?"favorite-active":"favorite-inactive"]),title:t.inPortfolio?"Remove from portfolio":"Add to portfolio"},(0,n.v_)(t.inPortfolio?"⭐":"☆"),11,x)]),(0,a.Lk)("td",D,[(0,a.Lk)("span",E,"#"+(0,n.v_)(t.rank),1),(0,a.Lk)("img",{src:t.image,alt:t.symbol,class:"coin-icon"},null,8,I)]),(0,a.Lk)("td",null,[(0,a.Lk)("a",{href:`https://www.coingecko.com/en/coins/${t.id}`,target:"_blank",class:"coin-link",title:t.name},(0,n.v_)(t.symbol.toUpperCase()),9,A)]),(0,a.Lk)("td",null,"$"+(0,n.v_)(Et.formatPrice(t.price)),1),(0,a.Lk)("td",{class:(0,n.C4)(["price-change-pill",Et.getPriceChangeClass(t.priceChange24h)])},(0,n.v_)(Et.formatPriceChange(t.priceChange24h)),3),(0,a.Lk)("td",j,[(0,a.Lk)("div",F,[(0,a.Lk)("div",V," $"+(0,n.v_)(Et.formatPrice(t.holdings*t.price)),1),(0,a.Lk)("div",{class:(0,n.C4)(["pnl-text",Et.getPnLClass(t.pnl)])},[(0,a.eW)((0,n.v_)(Et.formatPnL(t.pnl))+" ",1),t.holdings?((0,a.uX)(),(0,a.CE)("small",U," ("+(0,n.v_)(Et.formatPnLPercentage(t.pnl,t.holdings*t.price))+") ",1)):(0,a.Q3)("",!0)],2)]),(0,a.Lk)("div",H,[(0,a.Lk)("button",{onClick:s=>Et.openTransactionModal(t),class:"action-btn",title:"Add Transaction"},s[33]||(s[33]=[(0,a.Lk)("span",{class:"action-icon"},"💰",-1),(0,a.Lk)("span",{class:"action-text"},"Add",-1)]),8,M),(0,a.Lk)("button",{onClick:s=>Et.viewTransactions(t),class:"action-btn",title:"View Transactions"},s[34]||(s[34]=[(0,a.Lk)("span",{class:"action-icon"},"📊",-1),(0,a.Lk)("span",{class:"action-text"},"View",-1)]),8,W)])])])))),128))])])]),Dt.loading?((0,a.uX)(),(0,a.CE)("div",X,s[35]||(s[35]=[(0,a.Lk)("div",{class:"spinner-border text-light",role:"status"},[(0,a.Lk)("span",{class:"visually-hidden"},"Loading...")],-1)]))):(0,a.Q3)("",!0),Dt.error?((0,a.uX)(),(0,a.CE)("div",Q,(0,n.v_)(Dt.error),1)):(0,a.Q3)("",!0),s[45]||(s[45]=(0,a.Lk)("footer",{class:"footer"},[(0,a.Lk)("a",{href:"https://chrome.google.com/webstore/detail/mdw-crypto-portfolio-track/njpeiacpcgcfdojjedocmegpkcljibmk",target:"_blank",class:"store-link"}," Available on Chrome Web Store "),(0,a.Lk)("span",{class:"link-separator"},"•"),(0,a.Lk)("a",{href:"https://github.com/MichelDevWeb/MDW-Crypto-Tracker/tree/main",target:"_blank",class:"store-link"}," View on GitHub ")],-1)),Dt.showTransactionModal?((0,a.uX)(),(0,a.CE)("div",O,[(0,a.Lk)("div",z,[(0,a.Lk)("h3",null,(0,n.v_)(Dt.editingTransaction?"Edit":"Add")+" Transaction for "+(0,n.v_)(Dt.selectedCoin?.name),1),(0,a.Lk)("form",{onSubmit:s[20]||(s[20]=(0,o.D$)(((...t)=>Et.saveTransaction&&Et.saveTransaction(...t)),["prevent"]))},[(0,a.Lk)("div",B,[s[36]||(s[36]=(0,a.Lk)("label",null,"Type:",-1)),(0,a.Lk)("div",Z,[(0,a.Lk)("button",{type:"button",class:(0,n.C4)(["type-btn","buy"===Dt.transaction.type?"active":""]),onClick:s[14]||(s[14]=t=>Dt.transaction.type="buy")}," Buy ",2),(0,a.Lk)("button",{type:"button",class:(0,n.C4)(["type-btn","sell"===Dt.transaction.type?"active":""]),onClick:s[15]||(s[15]=t=>Dt.transaction.type="sell")}," Sell ",2)])]),(0,a.Lk)("div",q,[s[37]||(s[37]=(0,a.Lk)("label",null,"Amount:",-1)),(0,a.Lk)("div",J,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":s[16]||(s[16]=t=>Dt.transaction.amount=t),step:"any",required:"",class:"enhanced-input"},null,512),[[o.Jo,Dt.transaction.amount]]),(0,a.Lk)("span",K,"≈ $"+(0,n.v_)(Et.formatPrice(Dt.transaction.amount*Dt.transaction.price)),1)])]),(0,a.Lk)("div",R,[s[38]||(s[38]=(0,a.Lk)("label",null,"Price per coin:",-1)),(0,a.Lk)("div",G,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":s[17]||(s[17]=t=>Dt.transaction.price=t),step:"any",required:"",class:"enhanced-input"},null,512),[[o.Jo,Dt.transaction.price]]),(0,a.Lk)("span",N,"Current: $"+(0,n.v_)(Et.formatPrice(Dt.selectedCoin?.price)),1)])]),(0,a.Lk)("div",Y,[s[39]||(s[39]=(0,a.Lk)("label",null,"Date:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"datetime-local","onUpdate:modelValue":s[18]||(s[18]=t=>Dt.transaction.date=t),required:"",class:"enhanced-input"},null,512),[[o.Jo,Dt.transaction.date]])]),null!==Et.transactionPnL?((0,a.uX)(),(0,a.CE)("div",tt,[s[40]||(s[40]=(0,a.Lk)("div",{class:"preview-label"},"Transaction PnL:",-1)),(0,a.Lk)("div",{class:(0,n.C4)(["preview-value",Et.getPnLClass(Et.transactionPnL)])},(0,n.v_)(Et.formatPnL(Et.transactionPnL)),3)])):(0,a.Q3)("",!0),(0,a.Lk)("div",st,[(0,a.Lk)("button",et,(0,n.v_)(Dt.editingTransaction?"Update":"Save"),1),(0,a.Lk)("button",{type:"button",onClick:s[19]||(s[19]=(...t)=>Et.closeTransactionModal&&Et.closeTransactionModal(...t)),class:"btn-secondary"}," Cancel ")])],32)])])):(0,a.Q3)("",!0),Dt.showTransactionHistory?((0,a.uX)(),(0,a.CE)("div",ot,[(0,a.Lk)("div",at,[(0,a.Lk)("div",it,[(0,a.Lk)("div",nt,[(0,a.Lk)("img",{src:Dt.selectedCoin?.image,alt:Dt.selectedCoin?.symbol,class:"coin-header-icon"},null,8,rt),(0,a.Lk)("h3",null,(0,n.v_)(Dt.selectedCoin?.symbol.toUpperCase())+" Transactions",1)]),(0,a.Lk)("button",{onClick:s[21]||(s[21]=(...t)=>Et.closeTransactionHistory&&Et.closeTransactionHistory(...t)),class:"close-btn"}," × ")]),(0,a.Lk)("div",ct,[(0,a.Lk)("div",lt,[s[41]||(s[41]=(0,a.Lk)("div",{class:"summary-label"},"Holdings",-1)),(0,a.Lk)("div",dt,[(0,a.eW)((0,n.v_)(Dt.selectedCoin?.holdings)+" ",1),(0,a.Lk)("span",pt,(0,n.v_)(Dt.selectedCoin?.symbol.toUpperCase()),1)])]),(0,a.Lk)("div",ht,[s[42]||(s[42]=(0,a.Lk)("div",{class:"summary-label"},"Avg. Price",-1)),(0,a.Lk)("div",ut," $"+(0,n.v_)(Et.formatPrice(Et.calculateAveragePrice(Dt.selectedCoin))),1)]),(0,a.Lk)("div",mt,[s[43]||(s[43]=(0,a.Lk)("div",{class:"summary-label"},"Total Value",-1)),(0,a.Lk)("div",kt," $"+(0,n.v_)(Et.formatPrice(Dt.selectedCoin?.holdings*Dt.selectedCoin?.price)),1)]),(0,a.Lk)("div",gt,[s[44]||(s[44]=(0,a.Lk)("div",{class:"summary-label"},"Total P&L",-1)),(0,a.Lk)("div",{class:(0,n.C4)(["summary-value",Et.getPnLClass(Dt.selectedCoin?.pnl)])},[(0,a.eW)((0,n.v_)(Et.formatPnL(Dt.selectedCoin?.pnl))+" ",1),(0,a.Lk)("small",null,"("+(0,n.v_)(Et.formatPnLPercentage(Dt.selectedCoin?.pnl,Dt.selectedCoin?.holdings*Dt.selectedCoin?.price))+")",1)],2)])]),(0,a.Lk)("div",vt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Dt.coinTransactions,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:(0,n.C4)(["tx-item",t.type])},[(0,a.Lk)("div",ft,[(0,a.Lk)("div",yt,[(0,a.Lk)("span",Ct,(0,n.v_)("buy"===t.type?"↓":"↑"),1),(0,a.eW)(" "+(0,n.v_)(t.type.toUpperCase()),1)]),(0,a.Lk)("div",Lt,[(0,a.eW)((0,n.v_)(t.amount)+" ",1),(0,a.Lk)("span",bt,(0,n.v_)(Dt.selectedCoin?.symbol.toUpperCase()),1)]),(0,a.Lk)("div",Pt,"$"+(0,n.v_)(Et.formatPrice(t.price)),1),(0,a.Lk)("div",wt," $"+(0,n.v_)(Et.formatPrice(t.amount*t.price)),1),(0,a.Lk)("div",{class:(0,n.C4)(["tx-pnl",Et.getPnLClass(Et.calculateTransactionPnL(t))])},(0,n.v_)(Et.formatPnL(Et.calculateTransactionPnL(t))),3)]),(0,a.Lk)("div",_t,[(0,a.Lk)("span",Tt,(0,n.v_)(new Date(t.timestamp).toLocaleString()),1),(0,a.Lk)("div",St,[(0,a.Lk)("button",{onClick:s=>Et.editTransaction(t),class:"action-mini",title:"Edit"}," ✎ ",8,$t),(0,a.Lk)("button",{onClick:s=>Et.deleteTransaction(t),class:"action-mini",title:"Delete"}," 🗑 ",8,xt)])])],2)))),128))])])])):(0,a.Q3)("",!0)])}const Et={data(){return{coins:[],loading:!1,error:null,searchQuery:"",selectedApi:"coingecko",pageSize:25,portfolio:new Set,currentPage:1,totalPages:10,showPortfolio:!0,showTransactionModal:!1,selectedCoin:null,transaction:{type:"buy",amount:0,price:0,date:(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16)},sortConfig:{key:"rank",direction:"asc"},showTransactionHistory:!1,coinTransactions:[],editingTransaction:null}},computed:{portfolioCoins(){return this.coins.filter((t=>this.portfolio.has(t.id)))},displayedCoins(){return this.showPortfolio?this.portfolioCoins:this.coins},sortedCoins(){const t=[...this.displayedCoins];return this.sortConfig.key?t.sort(((t,s)=>{let e=t[this.sortConfig.key],o=s[this.sortConfig.key];return"symbol"===this.sortConfig.key?(e=e.toUpperCase(),o=o.toUpperCase()):"holdings"===this.sortConfig.key?(e=e||0,o=o||0):"value"===this.sortConfig.key&&(e=(t.holdings||0)*t.price,o=(s.holdings||0)*s.price),e<o?"asc"===this.sortConfig.direction?-1:1:e>o?"asc"===this.sortConfig.direction?1:-1:0})):t},transactionPnL(){if(!this.selectedCoin||!this.transaction.amount||!this.transaction.price)return null;const t=this.selectedCoin.price*this.transaction.amount,s=this.transaction.price*this.transaction.amount;return"buy"===this.transaction.type?t-s:s-t},totalCost(){return this.portfolioCoins.reduce(((t,s)=>{const e=s.transactions||[];let o=0,a=0;return e.forEach((t=>{"buy"===t.type?(o+=t.price*t.amount,a+=t.amount):(o-=t.price*t.amount,a-=t.amount)})),t+o}),0)},totalValue(){return this.portfolioCoins.reduce(((t,s)=>t+s.holdings*s.price),0)},totalProfitLoss(){return this.totalValue-this.totalCost}},methods:{async fetchCoins(){this.loading=!0,this.error=null;try{if(this.showPortfolio){const{portfolio:t=[]}=await chrome.storage.sync.get("portfolio");if("coingecko"===this.selectedApi){const s=t.join(",");if(s){const t=await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${s}&order=market_cap_desc`),e=await t.json();this.coins=this.parseCoingeckoData(e)}else this.coins=[]}else{const s=t.map((async t=>{const s=await fetch(`https://api.coincap.io/v2/assets/${t}`),{data:e}=await s.json();return e})),e=await Promise.all(s);this.coins=this.parseCoinCapData(e)}}else{const t="coingecko"===this.selectedApi?`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=${this.pageSize}&page=${this.currentPage}`:`https://api.coincap.io/v2/assets?limit=${this.pageSize}&offset=${(this.currentPage-1)*this.pageSize}`,s=await fetch(t),e=await s.json();this.coins="coingecko"===this.selectedApi?this.parseCoingeckoData(e):this.parseCoinCapData(e.data)}await this.updateHoldings()}catch(t){this.error="Failed to fetch cryptocurrency data",console.error(t)}finally{this.loading=!1}},parseCoingeckoData(t){return t.map((t=>({id:t.id,symbol:t.symbol,name:t.name,image:t.image,rank:t.market_cap_rank,price:t.current_price,priceChange24h:t.price_change_percentage_24h,inPortfolio:this.portfolio.has(t.id)})))},parseCoinCapData(t){return t.map((t=>({id:t.id,symbol:t.symbol,name:t.name,image:`https://assets.coincap.io/assets/icons/${t.symbol.toLowerCase()}@2x.png`,rank:t.rank,price:parseFloat(t.priceUsd),priceChange24h:parseFloat(t.changePercent24Hr),inPortfolio:this.portfolio.has(t.id)})))},formatPrice(t){return null===t||void 0===t?"N/A":t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:6})},formatPriceChange(t){return null===t||void 0===t?"N/A":`${t>=0?"+":""}${t.toFixed(2)}%`},getPriceChangeClass(t){return{profit:t>0,loss:t<0,neutral:0===t}},async handleSearch(){if(this.searchQuery.length>2){this.loading=!0,this.error=null;try{let t;if("coingecko"===this.selectedApi){t=`https://api.coingecko.com/api/v3/search?query=${this.searchQuery}`;const s=await fetch(t),e=await s.json(),o=e.coins.slice(0,this.pageSize).map((t=>t.id)).join(",");if(o){const t=await fetch(`https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${o}&order=market_cap_desc`),s=await t.json();this.coins=this.parseCoingeckoData(s)}else this.coins=[]}else{t=`https://api.coincap.io/v2/assets?search=${this.searchQuery}&limit=${this.pageSize}`;const s=await fetch(t),e=await s.json();this.coins=this.parseCoinCapData(e.data)}}catch(t){this.error="Failed to search cryptocurrencies",console.error(t)}finally{this.loading=!1}}else 0===this.searchQuery.length&&this.fetchCoins()},handleApiChange(){this.fetchCoins()},togglePortfolio(t){this.portfolio.has(t.id)?this.portfolio.delete(t.id):this.portfolio.add(t.id),t.inPortfolio=!t.inPortfolio,this.savePortfolio()},async savePortfolio(){await chrome.storage.sync.set({portfolio:Array.from(this.portfolio)})},async loadPortfolio(){const t=await chrome.storage.sync.get("portfolio");this.portfolio=new Set(t.portfolio||[]),this.showPortfolio=this.portfolio.size>0},togglePortfolioView(){this.showPortfolio=!this.showPortfolio,this.fetchCoins()},formatHoldings(t){return t||"0"},openTransactionModal(t){this.selectedCoin=t,this.transaction.price=t.price,this.transaction.date=(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16),this.showTransactionModal=!0},closeTransactionModal(){this.showTransactionModal=!1,this.selectedCoin=null,this.transaction={type:"buy",amount:0,price:0,date:(new Date).toLocaleString("sv-SE",{timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone}).slice(0,16)}},async saveTransaction(){try{const t={...this.transaction,coinId:this.selectedCoin.id,timestamp:new Date(this.transaction.date).getTime()},{transactions:s=[]}=await chrome.storage.sync.get("transactions");let e=[...s];if(this.editingTransaction){const o=s.findIndex((t=>t.timestamp===this.editingTransaction.timestamp&&t.coinId===this.editingTransaction.coinId));-1!==o&&(e[o]=t)}else e.push(t);if(await chrome.storage.sync.set({transactions:e}),await this.updateHoldings(),this.showTransactionHistory&&this.selectedCoin){const t=this.coins.find((t=>t.id===this.selectedCoin.id));this.selectedCoin=t;const s=e.filter((t=>t.coinId===this.selectedCoin.id));this.coinTransactions=s.sort(((t,s)=>s.timestamp-t.timestamp))}this.editingTransaction=null,this.closeTransactionModal()}catch(t){console.error("Failed to save transaction:",t)}},async updateHoldings(){const{transactions:t=[]}=await chrome.storage.sync.get("transactions"),s={},e={};t.forEach((t=>{s[t.coinId]||(s[t.coinId]=0,e[t.coinId]=[]),s[t.coinId]+="buy"===t.type?t.amount:-t.amount,e[t.coinId].push(t)})),this.coins=this.coins.map((t=>({...t,holdings:s[t.id]||0,transactions:e[t.id]||[],pnl:this.calculatePnL({...t,holdings:s[t.id]||0,transactions:e[t.id]||[]})})))},sortBy(t){this.sortConfig.key===t?this.sortConfig.direction="asc"===this.sortConfig.direction?"desc":"asc":(this.sortConfig.key=t,this.sortConfig.direction="asc")},getSortIcon(t){return this.sortConfig.key!==t?"↕️":"asc"===this.sortConfig.direction?"↑":"↓"},async viewTransactions(t){this.selectedCoin=t;const{transactions:s=[]}=await chrome.storage.sync.get("transactions");this.coinTransactions=s.filter((s=>s.coinId===t.id)).sort(((t,s)=>s.timestamp-t.timestamp)),this.showTransactionHistory=!0},closeTransactionHistory(){this.showTransactionHistory=!1,this.selectedCoin=null,this.coinTransactions=[]},editTransaction(t){this.editingTransaction=t,this.transaction={type:t.type,amount:t.amount,price:t.price,date:new Date(t.timestamp).toLocaleString("sv-SE").slice(0,16)},this.showTransactionModal=!0},async deleteTransaction(t){if(confirm("Are you sure you want to delete this transaction?"))try{const{transactions:s=[]}=await chrome.storage.sync.get("transactions"),e=s.filter((s=>s.timestamp!==t.timestamp||s.coinId!==t.coinId));if(await chrome.storage.sync.set({transactions:e}),await this.updateHoldings(),this.selectedCoin){const t=this.coins.find((t=>t.id===this.selectedCoin.id));this.selectedCoin=t;const s=e.filter((t=>t.coinId===this.selectedCoin.id));this.coinTransactions=s.sort(((t,s)=>s.timestamp-t.timestamp))}}catch(s){console.error("Failed to delete transaction:",s)}},calculatePnL(t){if(!t.holdings||!t.transactions)return 0;let s=0,e=0;t.transactions.forEach((t=>{"buy"===t.type?(s+=t.price*t.amount,e+=t.amount):(s-=t.price*t.amount,e-=t.amount)}));const o=e?s/e:0,a=t.price*t.holdings,i=o*t.holdings;return a-i},formatPnL(t){return t?`${t>=0?"+":""}$${Math.abs(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:"$0.00"},getPnLClass(t){return t?t>0?"profit":"loss":"neutral"},calculateTransactionPnL(t){if(!this.selectedCoin||!t)return 0;const s=this.selectedCoin.price*t.amount,e=t.price*t.amount;return"buy"===t.type?s-e:e-s},formatPnLPercentage(t,s){if(!s)return"0%";const e=t/Math.abs(s)*100;return`${e>=0?"+":""}${e.toFixed(2)}%`},calculateAveragePrice(t){if(!t?.transactions||0===t.transactions.length)return 0;let s=0,e=0;return t.transactions.forEach((t=>{"buy"===t.type?(s+=t.price*t.amount,e+=t.amount):(s-=t.price*t.amount,e-=t.amount)})),e?s/e:0}},async mounted(){await this.loadPortfolio(),await this.fetchCoins(),await this.updateHoldings()}};var It=e(262);const At=(0,It.A)(Et,[["render",Dt],["__scopeId","data-v-77566762"]]),jt=At,Ft={name:"App",components:{Popup:jt}},Vt=(0,It.A)(Ft,[["render",i]]),Ut=Vt,Ht=(0,o.Ef)(Ut);Ht.mount("#app")}},s={};function e(o){var a=s[o];if(void 0!==a)return a.exports;var i=s[o]={exports:{}};return t[o](i,i.exports,e),i.exports}e.m=t,(()=>{var t=[];e.O=(s,o,a,i)=>{if(!o){var n=1/0;for(d=0;d<t.length;d++){for(var[o,a,i]=t[d],r=!0,c=0;c<o.length;c++)(!1&i||n>=i)&&Object.keys(e.O).every((t=>e.O[t](o[c])))?o.splice(c--,1):(r=!1,i<n&&(n=i));if(r){t.splice(d--,1);var l=a();void 0!==l&&(s=l)}}return s}i=i||0;for(var d=t.length;d>0&&t[d-1][2]>i;d--)t[d]=t[d-1];t[d]=[o,a,i]}})(),(()=>{e.d=(t,s)=>{for(var o in s)e.o(s,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:s[o]})}})(),(()=>{e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{e.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s)})(),(()=>{var t={57:0};e.O.j=s=>0===t[s];var s=(s,o)=>{var a,i,[n,r,c]=o,l=0;if(n.some((s=>0!==t[s]))){for(a in r)e.o(r,a)&&(e.m[a]=r[a]);if(c)var d=c(e)}for(s&&s(o);l<n.length;l++)i=n[l],e.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return e.O(d)},o=self["webpackChunkmdw_crypto_portfolio_tracker"]=self["webpackChunkmdw_crypto_portfolio_tracker"]||[];o.forEach(s.bind(null,0)),o.push=s.bind(null,o.push.bind(o))})();var o=e.O(void 0,[504],(()=>e(121)));o=e.O(o)})();